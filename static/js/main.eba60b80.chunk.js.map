{"version":3,"sources":["bluetooth.ts","history.ts","App.tsx","wakeLock.ts","index.tsx"],"names":["ConnectionState","CUBE_TIME_UUID","reducer","state","action","timerState","epoch","duration","newState","initialData","useHistory","React","useReducer","history","dispatch","useEffect","historyData","useMemo","orderedHistory","Object","entries","map","a","b","parseInt","sort","values","Infinity","best","length","reduce","Math","min","undefined","avg5results","slice","avg5","avg12results","avg12","getHistoryData","JSON","parse","window","localStorage","getItem","console","log","setItem","stringify","formatDuration","milliseconds","Date","max","toISOString","substr","replace","FakeRunTime","useState","count","setCount","rafRef","useRef","previousTimeRef","animate","useCallback","time","current","deltaTime","prevCount","requestAnimationFrame","cancelAnimationFrame","className","CubeDisplay","isRunning","isInspection","isDefaultState","App","enabled","NOT_CONNECTED","connectionState","setConnectionState","device","setDevice","setTimerState","connect","CONNECTING","navigator","bluetooth","requestDevice","filters","services","connectGatt","gatt","getPrimaryService","service","getCharacteristic","characteristic","oncharacteristicvaluechanged","value","getUint32","byteLength","getInt32","readValue","startNotifications","CONNECTED","error","FAILED","disconnect","then","addEventListener","removeEventListener","useBluetooth","wakeLock","request","sentinel","info","acquire","release","List","ListItem","dense","ListItemText","primary","secondary","labelId","role","id","ListItemSecondaryAction","IconButton","edge","aria-label","onClick","disabled","button","startIcon","variant","color","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.eba60b80.chunk.js","sourcesContent":["import React from \"react\";\n\nconst CUBE_TIME_UUID = \"eb0e77c3-af14-4b7f-ac80-d3631dc386ac\";\nconst CHARACTERISTIC_UUID = \"eb0e77c3-af14-4b7f-ac80-d3631dc386ad\";\n\nexport interface TimerState {\n  state: number;\n  epoch: number;\n  duration: number;\n}\n\nexport enum ConnectionState {\n  NOT_CONNECTED,\n  CONNECTING,\n  CONNECTED,\n  FAILED,\n}\n\nexport interface UseBluetoothResult {\n  connect(): void;\n  disconnect(): void;\n  connectionState: ConnectionState;\n  timerState: TimerState;\n}\n\nexport function useBluetooth(): UseBluetoothResult {\n  const [connectionState, setConnectionState] = React.useState<ConnectionState>(\n    ConnectionState.NOT_CONNECTED\n  );\n  const [device, setDevice] = React.useState<BluetoothDevice | null>(null);\n  const [timerState, setTimerState] = React.useState<TimerState>({\n    state: 0,\n    epoch: 0,\n    duration: 0,\n  });\n\n  const connect = React.useCallback(async () => {\n    setConnectionState(ConnectionState.CONNECTING);\n    try {\n      const device = await navigator.bluetooth.requestDevice({\n        filters: [{ services: [CUBE_TIME_UUID] }],\n      });\n      setDevice(device);\n    } catch (e) {\n      // User has likely canceled the dialog, or didn't find\n      // the device, so we don't treat this as error.\n      setConnectionState(ConnectionState.NOT_CONNECTED);\n    }\n  }, []);\n\n  const connectGatt = React.useCallback(async () => {\n    try {\n      setConnectionState(ConnectionState.CONNECTING);\n      await device!.gatt?.connect();\n      const service = await device!.gatt?.getPrimaryService(CUBE_TIME_UUID);\n      const characteristic = await service?.getCharacteristic(\n        CHARACTERISTIC_UUID\n      );\n      characteristic!.oncharacteristicvaluechanged = () => {\n        const state = characteristic!.value!.getUint32(0, true);\n        const epoch = characteristic!.value!.getUint32(4, true);\n        const duration =\n          characteristic!.value!.byteLength > 4\n            ? characteristic!.value!.getInt32(8, true)\n            : 0;\n\n        setTimerState({ state, epoch, duration });\n      };\n      await characteristic?.readValue();\n      characteristic?.startNotifications();\n      setConnectionState(ConnectionState.CONNECTED);\n    } catch (e) {\n      console.error(e);\n      setConnectionState(ConnectionState.FAILED);\n    }\n  }, [device]);\n\n  const disconnect = async () => {\n    setDevice(null);\n  };\n\n  React.useEffect(() => {\n    if (!device) {\n      setConnectionState(ConnectionState.NOT_CONNECTED);\n      return () => {};\n    }\n\n    connectGatt().then(() =>\n      device.addEventListener(\"gattserverdisconnected\", connectGatt)\n    );\n\n    return () => {\n      device.removeEventListener(\"gattserverdisconnected\", connectGatt);\n      device.gatt?.disconnect();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [connectGatt]);\n\n  return {\n    connect,\n    disconnect,\n    connectionState,\n    timerState,\n  };\n}\n","import React from \"react\";\nimport { TimerState } from \"./bluetooth\";\n\ninterface HistoryAction {\n  action: \"push\" | \"delete\" | \"clear\" | \"initialize\";\n  epoch?: number;\n  timerState?: TimerState;\n  initialData?: Record<number, number>;\n}\n\nfunction reducer(\n  state: Record<number, number>,\n  action: HistoryAction\n): Record<number, number> {\n  switch (action.action) {\n    case \"push\": {\n      if (state[action.timerState!.epoch] === action.timerState!.duration)\n        return state;\n      const newState = { ...state };\n      if (action.timerState!.duration !== 0) {\n        newState[action.timerState!.epoch] = action.timerState!.duration;\n      } else {\n        delete newState[action.timerState!.epoch];\n      }\n      return newState;\n    }\n    case \"delete\": {\n      const newState = { ...state };\n      delete newState[action.epoch!];\n      return newState;\n    }\n    case \"clear\":\n      return {};\n    case \"initialize\":\n      return action.initialData!;\n  }\n}\n\ninterface HistoryData {\n  orderedHistory: [number, number][];\n  best?: number;\n  avg5?: number;\n  avg12?: number;\n}\n\nfunction getHistoryData(history: Record<number, number>): HistoryData {\n  const orderedHistory = Object.entries(history)\n    .map(([a, b]) => [parseInt(a), b])\n    .sort((a, b) => b[0] - a[0]);\n\n  const values = orderedHistory.map(([a, b]) => (b === -1 ? Infinity : b));\n  const best =\n    values.length > 0\n      ? values.reduce((a, b) => Math.min(a, b), Infinity)\n      : undefined;\n  const avg5results = values.slice(0, 5).sort((a, b) => a - b);\n  const avg5 =\n    avg5results.length === 5\n      ? avg5results.slice(1, 4).reduce((a, b) => a + b, 0) / 3\n      : undefined;\n  const avg12results = values.slice(0, 12).sort((a, b) => a - b);\n  const avg12 =\n    avg12results.length === 12\n      ? avg12results.slice(1, 11).reduce((a, b) => a + b, 0) / 10\n      : undefined;\n\n  return {\n    orderedHistory: orderedHistory as [number, number][],\n    best: best === Infinity ? -1 : best,\n    avg5: avg5 === Infinity ? -1 : avg5,\n    avg12: avg12 === Infinity ? -1 : avg12,\n  };\n}\n\nexport function useHistory(\n  timerState: TimerState\n): [HistoryData, React.Dispatch<HistoryAction>] {\n  const [history, dispatch] = React.useReducer(reducer, {});\n  React.useEffect(() => {\n    dispatch({ action: \"push\", timerState });\n  }, [timerState]);\n\n  const historyData = React.useMemo(() => getHistoryData(history), [history]);\n\n  React.useEffect(() => {\n    dispatch({\n      action: \"initialize\",\n      initialData: JSON.parse(window.localStorage.getItem(\"history\") || \"{}\"),\n    });\n  }, []);\n\n  React.useEffect(() => {\n    console.log(history);\n    window.localStorage.setItem(\"history\", JSON.stringify(history));\n  }, [history]);\n\n  return [historyData, dispatch];\n}\n","import Button from \"@material-ui/core/Button/Button\";\nimport React from \"react\";\nimport \"./App.css\";\nimport { ConnectionState, TimerState, useBluetooth } from \"./bluetooth\";\nimport { useWakeLock } from \"./wakeLock\";\nimport { useHistory } from \"./history\";\n\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport BluetoothIcon from \"@material-ui/icons/Bluetooth\";\nimport BluetoothDisabledIcon from \"@material-ui/icons/BluetoothDisabled\";\nimport Card from \"@material-ui/core/Card/Card\";\n\nexport function formatDuration(milliseconds: number): string {\n  if (milliseconds === -1) {\n    return \"DNF\";\n  }\n  return new Date(Math.max(0, milliseconds))\n    .toISOString()\n    .substr(14, 9)\n    .replace(/^[0:]+(?!\\.)/, \"\");\n}\n\n/**\n * While the timer is running, the device does not send anything via Bluetooth,\n * so we fake the running time display locally. Once the timer is stopped, the\n * correct time from the device will be displayed.\n */\nfunction FakeRunTime() {\n  const [count, setCount] = React.useState(0);\n\n  const rafRef = React.useRef<number>();\n  const previousTimeRef = React.useRef<number>();\n\n  const animate = React.useCallback((time: number) => {\n    if (previousTimeRef.current !== undefined) {\n      const deltaTime = time - previousTimeRef.current;\n      setCount((prevCount) => prevCount + deltaTime);\n    }\n    previousTimeRef.current = time;\n    rafRef.current = requestAnimationFrame(animate);\n  }, []);\n\n  React.useEffect(() => {\n    rafRef.current = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(rafRef.current!);\n  }, [animate]);\n\n  return <span className=\"running\">{formatDuration(count)}</span>;\n}\n\ninterface CubeDisplayProps {\n  timerState: TimerState;\n}\n\nfunction CubeDisplay({ timerState }: CubeDisplayProps) {\n  const { state, duration } = timerState;\n  const isRunning = state >= 20 && state < 30;\n  const isInspection = state >= 10 && state < 20;\n  const isDefaultState = !isRunning && !isInspection;\n\n  return (\n    <>\n      {isDefaultState && duration !== 0 && <>{formatDuration(duration)}</>}\n      {isDefaultState && duration === 0 && <>Ready!</>}\n      {isRunning && <FakeRunTime />}\n      {isInspection && <span className=\"inspection\">Inspection</span>}\n    </>\n  );\n}\n\nfunction App() {\n  const { connect, disconnect, connectionState, timerState } = useBluetooth();\n  const [{ orderedHistory, best, avg5, avg12 }, dispatch] = useHistory(\n    timerState\n  );\n\n  useWakeLock(\n    connectionState === ConnectionState.CONNECTED ||\n      connectionState === ConnectionState.CONNECTING\n  );\n\n  return (\n    <>\n      <div className=\"statusDisplay\">\n        {connectionState === ConnectionState.CONNECTED && (\n          <CubeDisplay timerState={timerState} />\n        )}\n      </div>\n      <Card className=\"card\">\n        <List className=\"stats\">\n          <ListItem dense>\n            <ListItemText\n              primary=\"Best\"\n              secondary={best !== undefined ? formatDuration(best) : \"-\"}\n            />\n          </ListItem>\n          <ListItem dense>\n            <ListItemText\n              primary=\"Avg 5\"\n              secondary={avg5 !== undefined ? formatDuration(avg5) : \"-\"}\n            />\n          </ListItem>\n          <ListItem dense>\n            <ListItemText\n              primary=\"Avg 12\"\n              secondary={avg12 !== undefined ? formatDuration(avg12) : \"-\"}\n            />\n          </ListItem>\n        </List>\n\n        <List className=\"results\">\n          {orderedHistory.map(([epoch, value]) => {\n            const labelId = `list-label-${epoch}`;\n\n            return (\n              <ListItem key={epoch} role={undefined} dense>\n                <ListItemText id={labelId} primary={formatDuration(value)} />\n                <ListItemSecondaryAction>\n                  <IconButton edge=\"end\" aria-label=\"comments\">\n                    <DeleteIcon\n                      onClick={() => dispatch({ action: \"delete\", epoch })}\n                    />\n                  </IconButton>\n                </ListItemSecondaryAction>\n              </ListItem>\n            );\n          })}\n          <ListItem\n            role={undefined}\n            dense\n            disabled={orderedHistory.length === 0}\n            onClick={() => dispatch({ action: \"clear\" })}\n            button\n          >\n            <ListItemText primary=\"Clear history\" />\n          </ListItem>\n        </List>\n      </Card>\n      {connectionState === ConnectionState.FAILED && (\n        <>\n          <Button startIcon={<BluetoothIcon />} onClick={connect}>\n            Connect\n          </Button>\n        </>\n      )}\n      {connectionState === ConnectionState.NOT_CONNECTED && (\n        <>\n          <Button\n            startIcon={<BluetoothIcon />}\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={connect}\n          >\n            Connect\n          </Button>\n        </>\n      )}\n      {connectionState === ConnectionState.CONNECTING && (\n        <>\n          <Button\n            startIcon={<BluetoothIcon />}\n            variant=\"contained\"\n            disabled\n            color=\"primary\"\n            onClick={connect}\n          >\n            Connecting...\n          </Button>\n        </>\n      )}\n      {connectionState === ConnectionState.CONNECTED && (\n        <Button\n          startIcon={<BluetoothDisabledIcon />}\n          variant=\"contained\"\n          color=\"default\"\n          onClick={disconnect}\n        >\n          Disconnect\n        </Button>\n      )}\n    </>\n  );\n}\n\nexport default App;\n","import React from \"react\";\n\nexport function useWakeLock(enabled: boolean) {\n  React.useEffect(() => {\n    if (!enabled) {\n      return () => {};\n    }\n\n    var sentinel: WakeLockSentinel | undefined;\n    const acquire = async () => {\n      try {\n        sentinel = await navigator.wakeLock.request(\"screen\");\n        console.info(\"We have the wake lock.\");\n        sentinel.addEventListener(\"release\", () => {\n          console.info(\"We no longer have the wake lock.\");\n        });\n      } catch (e) {\n        console.error(e);\n      }\n    };\n    acquire();\n\n    return () => {\n      sentinel?.release();\n    };\n  }, [enabled]);\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}